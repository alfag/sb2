{% extends "layout.njk" %}

{% block title %}Limite Richieste Superato - SharingBeer2{% endblock %}

{% block content %}
<div class="container mt-5">
    <div class="row justify-content-center">
        <div class="col-md-8 col-lg-6">
            <div class="card border-warning">
                <div class="card-header bg-warning text-dark text-center">
                    <h3><i class="fas fa-exclamation-triangle"></i> Limite Richieste Superato</h3>
                </div>
                <div class="card-body text-center">
                    <!-- Mostra il messaggio flash se presente -->
                    {% if message.error %}
                        <div class="alert alert-warning mb-4">
                            <i class="fas fa-clock"></i>
                            {{ message.error[0] if message.error is iterable else message.error }}
                        </div>
                    {% endif %}
                    
                    <!-- Messaggio generico se non c'è flash message -->
                    {% if not message.error %}
                        <div class="alert alert-warning mb-4">
                            <i class="fas fa-clock"></i>
                            Hai superato il limite di richieste consentite. Attendi qualche minuto prima di riprovare.
                        </div>
                    {% endif %}
                    
                    <div class="mb-4">
                        <i class="fas fa-hourglass-half fa-3x text-warning mb-3"></i>
                        <h4>Cosa è successo?</h4>
                        <p class="text-muted">
                            Il nostro sistema ha rilevato troppe richieste dal tuo indirizzo IP in un breve periodo di tempo. 
                            Questo è un meccanismo di protezione per garantire la stabilità del servizio per tutti gli utenti.
                        </p>
                    </div>
                    
                    <div class="mb-4">
                        <h5><i class="fas fa-lightbulb text-info"></i> Cosa puoi fare?</h5>
                        <div class="text-start">
                            <ul class="list-unstyled">
                                <li class="mb-2">
                                    <i class="fas fa-clock text-primary"></i> 
                                    <strong>Attendi qualche minuto</strong> e riprova più tardi
                                </li>
                                {% if not user %}
                                <li class="mb-2">
                                    <i class="fas fa-user-plus text-success"></i> 
                                    <strong>Registrati</strong> per avere limiti più alti
                                </li>
                                {% endif %}
                                <li class="mb-2">
                                    <i class="fas fa-shield-alt text-info"></i> 
                                    <strong>Evita richieste multiple</strong> simultanee
                                </li>
                                <li class="mb-2">
                                    <i class="fas fa-refresh text-warning"></i> 
                                    <strong>Non ricaricare</strong> continuamente la pagina
                                </li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="d-grid gap-2">
                        <a href="/" class="btn btn-primary">
                            <i class="fas fa-home"></i> Torna alla Home
                        </a>
                        
                        {% if user %}
                            {% if user.role and user.role.includes('brewery') %}
                                <a href="/brewery/dashboard" class="btn btn-outline-success">
                                    <i class="fas fa-tachometer-alt"></i> Dashboard Birrificio
                                </a>
                            {% endif %}
                            
                            {% if user.role and user.role.includes('administrator') %}
                                <a href="/administrator" class="btn btn-outline-info">
                                    <i class="fas fa-cogs"></i> Area Amministrativa
                                </a>
                            {% endif %}
                        {% else %}
                            <a href="/#login" class="btn btn-outline-success">
                                <i class="fas fa-sign-in-alt"></i> Accedi
                            </a>
                        {% endif %}
                    </div>
                    
                    <div class="mt-4 text-muted">
                        <small>
                            <i class="fas fa-info-circle"></i> 
                            I limiti si resettano automaticamente dopo il periodo di attesa.
                            {% if not user %}
                            Gli utenti registrati hanno limiti più alti e funzionalità aggiuntive.
                            {% endif %}
                        </small>
                    </div>
                </div>
            </div>
            
            <!-- Sezione informativa opzionale -->
            <div class="card mt-4 border-light">
                <div class="card-body">
                    <h6 class="card-title">
                        <i class="fas fa-question-circle text-info"></i> 
                        Perché questi limiti?
                    </h6>
                    <p class="card-text small text-muted">
                        I limiti di richieste ci aiutano a:
                    </p>
                    <ul class="small text-muted">
                        <li>Mantenere il servizio veloce per tutti</li>
                        <li>Proteggere dai tentativi di abuso</li>
                        <li>Garantire un uso equo delle risorse</li>
                        <li>Preservare la qualità dell'esperienza utente</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
/* Animazione per l'icona hourglass */
.fa-hourglass-half {
    animation: pulse 2s infinite;
}

@keyframes pulse {
    0% { opacity: 0.7; }
    50% { opacity: 1; }
    100% { opacity: 0.7; }
}

/* Stile per le card */
.card {
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    border-radius: 10px;
}

.card-header {
    border-radius: 10px 10px 0 0 !important;
}

/* Responsive adjustments */
@media (max-width: 576px) {
    .container {
        padding: 0 15px;
    }
    
    .card-body {
        padding: 1rem;
    }
    
    .fa-3x {
        font-size: 2rem !important;
    }
}
</style>
{% endblock %}
